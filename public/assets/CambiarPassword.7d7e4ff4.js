import{a as h,Q as C}from"./QCard.cb508ff7.js";import{a as P,Q as q}from"./QForm.f7dbdbf9.js";import{Q as w}from"./QInput.fb482f67.js";import{x as S,r as V,aU as x,aV as f,v as z,c as B,q as p,z as b,t as o,A as s,d as r,B as c,ac as E,u as g,aa as y,s as F,ar as L,F as D,ab as N,Q as k}from"./index.6aee2e30.js";import{Q as U}from"./QPage.6971c865.js";import{g as A}from"./errorUtils.9be85d5d.js";import{d as M}from"./documentosApi.f9b655d1.js";import{u as T}from"./useMutation.esm.2b00b620.js";import"./use-dark.6d3765c8.js";import"./focus-manager.05708ea9.js";import"./use-key-composition.138705f4.js";import"./uid.42677368.js";import"./use-form.7a2b9d0c.js";import"./axios.a596eead.js";import"./utils.esm.df383359.js";import"./useQueryClient.esm.ef5065e6.js";import"./mutation.esm.5dbe1dbb.js";const I=async l=>{try{f.show({delay:500,message:"Actualizando..."}),l.append("_method","PUT");const{data:a}=await M.post("editar-password",l,{headers:{"Content-Type":"multipart/form-data"}});return f.hide(),a}catch(a){throw f.hide(),a}},R=()=>{const l=S(),a=V(null),{mutate:m,isLoading:_,error:d}=T(I,{onSuccess:()=>{x.create({message:"Se actualiz\xF3 la contrase\xF1a",color:"positive",position:"top-right",type:"positive"}),l.push({name:"perfil-admin"})},onError:t=>{var u;x.create({message:t+"",color:"negative",position:"top-right",type:"negative"}),t.response?a.value=(u=t.response)==null?void 0:u.data:a.value=t}});return{actalizarPassword:m,isLoadingPassword:_,errorPassword:d,errorServer:a}},j={class:"row"},G={class:"col-md-8 col-sm-10 col-xs-12 q-pa-lg"},H={class:"row q-col-gutter-md"},J={class:"col-12"},K={class:"col-xs-12 col-sm-6"},O=s("span",{class:"required-star"},"*",-1),W={class:"col-xs-12 col-sm-6"},X=s("span",{class:"required-star"},"*",-1),Y={class:"col-xs-12 col-sm-6"},Z=s("span",{class:"required-star"},"*",-1),$={class:"col-xs-12 col-sm-7"},ge=z({__name:"CambiarPassword",setup(l){const a=V({current_password:"",password:"",password_confirmation:""}),{actalizarPassword:m,isLoadingPassword:_,errorServer:d}=R(),t=d.value,u=B(()=>A(d.value)),Q=()=>{const i=new FormData;i.append("current_password",a.value.current_password),i.append("password",a.value.password),i.append("password_confirmation",a.value.password_confirmation),m(i)};return(i,n)=>(p(),b(U,{padding:""},{default:o(()=>[s("div",j,[s("div",G,[r(C,null,{default:o(()=>[r(h,null,{default:o(()=>[c(" Cambiar contrase\xF1a ")]),_:1}),r(h,null,{default:o(()=>[r(P,{onSubmit:E(Q,["prevent"])},{default:o(()=>[s("div",H,[s("div",J,[g(d)?(p(),b(q,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:o(()=>{var e;return[c(y(((e=g(t))==null?void 0:e.message)||"")+" ",1),s("ul",null,[(p(!0),F(D,null,L(u.value,v=>(p(),F("li",{key:v},y(v),1))),128))])]}),_:1})):N("",!0)])]),s("div",K,[r(w,{modelValue:a.value.current_password,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value.current_password=e),"label-slot":"",rules:[e=>!!e||"La contrase\xF1a actual es requerida",e=>e.length>3&&e.length<255||"Debe tener m\xE1s de 3 caracteres y menos de 255"],type:"password"},{label:o(()=>[c(" Contrase\xF1a actual "),O]),_:1},8,["modelValue","rules"])]),s("div",W,[r(w,{modelValue:a.value.password,"onUpdate:modelValue":n[1]||(n[1]=e=>a.value.password=e),"label-slot":"",rules:[e=>!!e||"La nueva contrase\xF1a es requerida",e=>e.length>5&&e.length<255||"Debe tener m\xE1s de 5 caracteres y menos de 255"],type:"password"},{label:o(()=>[c(" Nueva contrase\xF1a "),X]),_:1},8,["modelValue","rules"])]),s("div",Y,[r(w,{modelValue:a.value.password_confirmation,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value.password_confirmation=e),"label-slot":"",rules:[e=>!!e||"La confirmaci\xF3n de contrase\xF1a es requerida",e=>e.length>5&&e.length<255||"Debe tener m\xE1s de 5 caracteres y menos de 255"],type:"password"},{label:o(()=>[c(" Confirmar contrase\xF1a "),Z]),_:1},8,["modelValue","rules"])]),s("div",$,[r(k,{label:"Cambiar contrase\xF1a",color:"primary",type:"submit",loading:g(_)},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1}))}});export{ge as default};
