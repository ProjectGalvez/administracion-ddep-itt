import{aU as z,aV as b,v as S,x as q,r as V,q as r,s as p,u as c,z as _,ab as C,d as t,A as o,Q as v,t as s,F as T,ar as j,ap as B,B as n,aa as i,aR as A,_ as F,C as U,D}from"./index.6aee2e30.js";import{a as E,Q as M}from"./QCard.cb508ff7.js";import{Q as K}from"./QPage.6971c865.js";import{Q as G}from"./QImg.7c114304.js";import{Q as m}from"./QChip.ec11ad7b.js";import{Q as H}from"./QCircularProgress.f50dd3f5.js";import{Q as J}from"./QBtnGroup.36c427f5.js";import{Q as O}from"./QMarkupTable.1bfa3264.js";import{d as L}from"./documentosApi.f9b655d1.js";import{_ as W}from"./DialogEliminar.4f6007ed.js";import{_ as X}from"./LoaderSpinner.e73a4608.js";import{u as Y}from"./useQueryClient.esm.ef5065e6.js";import{u as Z}from"./useMutation.esm.2b00b620.js";import{u as ee}from"./useQuery.esm.76380881.js";import{_ as oe}from"./BreadcrumbNav.15d15e07.js";import{u as te}from"./useVerPeriodoActivo.6be1c370.js";import"./use-dark.6d3765c8.js";import"./format.2bc25e5f.js";import"./axios.a596eead.js";import"./QCardActions.23796629.js";import"./QDialog.84ddac0d.js";import"./use-prevent-scroll.46e9c667.js";import"./focusout.012d42f6.js";import"./focus-manager.05708ea9.js";import"./ClosePopup.7bc30a2d.js";import"./utils.esm.df383359.js";import"./mutation.esm.5dbe1dbb.js";const se=async l=>{try{b.show({delay:500,message:"Cancelando residencia"}),await L.delete("residentes-cancelar/"+l),b.hide()}catch(d){throw b.hide(),d}},ae=()=>{const l=Y(),{mutate:d}=Z(se,{onSuccess:()=>{z.create({message:"Se cancel\xF3 la residencia",color:"positive",position:"top-right",type:"positive"}),l.invalidateQueries({queryKey:["residentes"],exact:!1})},onError:u=>{z.create({message:u+"",color:"negative",position:"top-right",type:"negative"})}});return{cancelarResidencia:d}};const re=l=>(U("data-v-4bd5d382"),l=l(),D(),l),ne={key:1},ie={class:"flex justify-end"},le=re(()=>o("thead",null,[o("tr",null,[o("th",null,"Estudiante"),o("th",null,"Empresa"),o("th",null,"Proyecto"),o("th",null,"Entregas"),o("th",null,"Acciones")])],-1)),ce={class:"flex items-center q-gutter-sm"},de={class:"columna-ancho-maximo"},ue={class:"flex column"},me={class:"columna-ancho-maximo"},_e={class:"flex column"},pe=S({__name:"TablaResidentes",setup(l){const d=async()=>{const{data:a}=await L.get("/residentes");return a},u=q(),f=V(!1),x=V(""),{isLoading:k,data:h}=ee({queryKey:["residentes"],queryFn:()=>d(),keepPreviousData:!0,staleTime:1e3*60*60}),{cancelarResidencia:Q}=ae(),w=a=>{f.value=!0,x.value=a},g=a=>{u.push({name:"ver-residente",params:{id:a}})},P=a=>{u.push({name:"editar-residente",params:{id:a}})},R=(a=0,y=0)=>{if(y===0)return 0;const e=a/y*100;return Math.round(e)},I="http://127.0.0.1:8000/api",N=async()=>{const a=I+"/residentes-export-pdf";window.open(a,"_blank")};return(a,y)=>(r(),p("div",null,[c(k)?(r(),_(X,{key:0})):C("",!0),c(h)&&c(h).length>0?(r(),p("div",ne,[t(W,{modelValue:f.value,"onUpdate:modelValue":y[0]||(y[0]=e=>f.value=e),"recurso-id":x.value,onEliminar:c(Q),mensaje:"\xBFEstas seguro de cancelar la residencia?"},null,8,["modelValue","recurso-id","onEliminar"]),o("div",ie,[o("div",null,[t(v,{round:"",icon:"picture_as_pdf",color:"negative",size:"sm",onClick:N})])]),t(O,null,{default:s(()=>[le,o("tbody",null,[(r(!0),p(T,null,j(c(h),e=>(r(),p("tr",{key:e.id_estudiante},[o("td",null,[o("div",ce,[o("div",null,[e.url_foto?(r(),_(B,{key:0},{default:s(()=>[t(G,{src:e.url_foto},null,8,["src"])]),_:2},1024)):(r(),_(B,{key:1,color:"primary","text-color":"white"},{default:s(()=>[n(i(e.iniciales_nombre_apellido),1)]),_:2},1024))]),o("div",null,[o("div",null,i(e.nombre_completo),1),o("div",null,[t(m,{dense:"",style:A({backgroundColor:e.color_carrera}),"text-color":"white"},{default:s(()=>[n(i(e.abrev_carrera),1)]),_:2},1032,["style"]),t(m,{dense:"",color:"secondary","text-color":"white",icon:"call"},{default:s(()=>[n(i(e.telefono_estudiante),1)]),_:2},1024)])])])]),o("td",de,[o("div",ue,[n(i(e.nombre_empresa)+" ",1),t(m,{dense:"",color:"secondary","text-color":"white",icon:"call"},{default:s(()=>[n(i(e.telefono_empresa),1)]),_:2},1024)])]),o("td",me,[o("div",_e,[n(i(e.proyecto)+" ",1),o("div",null,[t(m,{dense:"",color:"deep-purple","text-color":"white",icon:"checklist"},{default:s(()=>[n(i(e.tipo_proyecto),1)]),_:2},1024),e.nombre_asesor?(r(),_(m,{key:0,dense:"",color:"light-blue-10","text-color":"white",icon:"supervisor_account"},{default:s(()=>[n(i(e.nombre_asesor),1)]),_:2},1024)):(r(),_(m,{key:1,dense:"",color:"orange","text-color":"white",icon:"block"},{default:s(()=>[n(" No hay asesor asignado ")]),_:1}))])])]),o("td",null,[t(H,{"show-value":"","font-size":"12px",value:R(e.documentos_entregados,e.total_documentos),size:"50px",thickness:.22,color:"primary","track-color":"grey-3",class:"q-ma-md"},{default:s(()=>[n(i(R(e.documentos_entregados,e.total_documentos))+"% ",1)]),_:2},1032,["value"])]),o("td",null,[t(J,{push:""},{default:s(()=>[t(v,{size:"sm",color:"info",push:"",glossy:"",icon:"visibility",onClick:$=>g(e.id_estudiante)},null,8,["onClick"]),t(v,{size:"sm",color:"secondary",push:"",glossy:"",icon:"edit",onClick:$=>P(e.id_estudiante)},null,8,["onClick"]),t(v,{size:"sm",color:"negative",push:"",glossy:"",icon:"block",onClick:$=>w(e.id_estudiante)},null,8,["onClick"])]),_:2},1024)])]))),128))])]),_:1})])):C("",!0)]))}});var fe=F(pe,[["__scopeId","data-v-4bd5d382"]]);const he={class:"flex justify-between items-center"},ye={class:"fontsize-15 text-weight-light"},ve={key:0},ge={key:1},He=S({__name:"ListarResidente",setup(l){const d=q(),{resource:u,isLoading:f,error:x}=te(),k=()=>{d.push({name:"crear-residente"})},h=[{label:"Residentes",icon:"history_edu"}];return(Q,w)=>(r(),_(K,{padding:""},{default:s(()=>[t(oe,{pages:h,titlePage:"Lista de residentes"}),t(M,null,{default:s(()=>[t(E,null,{default:s(()=>{var g;return[o("div",he,[o("div",ye,[n(" Residentes del periodo "),c(f)?(r(),p("span",ve)):(g=c(u))!=null&&g.nombre?(r(),p("span",ge,i(c(u).nombre),1)):C("",!0)]),t(v,{label:"Asignar",icon:"add_circle_outline",color:"secondary",size:"md",padding:"xs",onClick:k})])]}),_:1}),t(E,null,{default:s(()=>[t(fe)]),_:1})]),_:1})]),_:1}))}});export{He as default};
