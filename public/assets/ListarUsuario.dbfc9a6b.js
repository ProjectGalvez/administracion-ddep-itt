import{v as $,x as S,r as _,q as f,s as g,d as e,u as n,t as o,B as v,aa as k,Q as c,A as V,z as F,ab as A}from"./index.b0b93e3c.js";import{a as C,Q as B}from"./QCard.4818aad5.js";import{Q as L}from"./QPage.f47cc484.js";import{_ as M}from"./BreadcrumbNav.fba4b1cf.js";import{g as I}from"./getUser.6e873b0d.js";import{Q as T,a as N,b as t,c as D}from"./QTable.311cecdc.js";import{Q as j}from"./QBtnGroup.70024cb3.js";import{u as G}from"./useRecursosMultiples.910dad85.js";import{_ as R}from"./DialogEliminar.7a03cb45.js";import{u as O}from"./useEliminarRecurso.035d2b48.js";import{Q as P}from"./QTooltip.2842ecd4.js";import{u as H}from"./useRecursosEliminados.488a0a1e.js";import{u as J}from"./useForzarEliminaci\xF3nRecurso.d2bcfbf2.js";import{u as K}from"./useRestaurarRecurso.5324161b.js";import"./use-dark.63c149ae.js";import"./QList.28d6af9b.js";import"./QMarkupTable.b45aab0d.js";import"./QSelect.c888b659.js";import"./use-key-composition.18531db8.js";import"./uid.42677368.js";import"./focus-manager.05708ea9.js";import"./QChip.d4a91c6e.js";import"./QItem.f4f583b9.js";import"./QItemLabel.933b096b.js";import"./QMenu.42e312bd.js";import"./position-engine.3be844ea.js";import"./selection.c0619a19.js";import"./focusout.c03edb12.js";import"./QDialog.ca25ac9d.js";import"./use-prevent-scroll.71b3f740.js";import"./use-form.cb72d743.js";import"./format.2bc25e5f.js";import"./use-checkbox.b6e065a6.js";import"./use-fullscreen.397c1cc4.js";import"./documentosApi.f427d296.js";import"./axios.a596eead.js";import"./useQuery.esm.ec0861c0.js";import"./useQueryClient.esm.98cf75d6.js";import"./utils.esm.728a0fef.js";import"./QCardActions.47971319.js";import"./ClosePopup.599d60b6.js";import"./useMutation.esm.16d51942.js";import"./mutation.esm.2cad5aca.js";const W=()=>G("/users",["users"],{included:"roles"},{staleTime:1e3*60*60}),q=[{field:"name",name:"name",label:"Usuario",align:"left",sortable:!0},{field:"email",name:"email",label:"Correo electr\xF3nico",align:"left",sortable:!0},{field:"rol",name:"rol",label:"Rol",align:"left",sortable:!0},{field:"accion",name:"accion",label:"Acci\xF3n",align:"right"}],X=()=>O("/users","Se elimin\xF3 el usuario"),Y={key:0},Z={key:1},ee=$({__name:"TablaUsers",setup(z){const a=S(),i=_(!1),u=_(""),{data:p,isLoading:y}=W(),{eliminarRecurso:h}=X(),b=m=>{a.push({name:"ver-usuario",params:{id:m}})},w=m=>{a.push({name:"editar-usuario",params:{id:m}})},E=m=>{i.value=!0,u.value=m};return(m,U)=>(f(),g("div",null,[e(R,{modelValue:i.value,"onUpdate:modelValue":U[0]||(U[0]=r=>i.value=r),"recurso-id":u.value,onEliminar:n(h)},null,8,["modelValue","recurso-id","onEliminar"]),e(T,{flat:"",bordered:"",rows:n(p),columns:n(q),"row-key":"name",loading:n(y),pagination:{rowsPerPage:15}},{body:o(r=>[e(N,{props:r},{default:o(()=>[e(t,{key:"name",props:r},{default:o(()=>[v(k(r.row.name),1)]),_:2},1032,["props"]),e(t,{key:"email",props:r},{default:o(()=>[v(k(r.row.email),1)]),_:2},1032,["props"]),e(t,{key:"rol",props:r},{default:o(()=>[r.row.roles&&r.row.roles.length>0?(f(),g("div",Y,k(r.row.roles[0].name),1)):(f(),g("div",Z,"Sin rol"))]),_:2},1032,["props"]),e(t,{key:"accion",props:r},{default:o(()=>[e(j,{push:""},{default:o(()=>[e(c,{size:"sm",color:"info",push:"",glossy:"",icon:"visibility",onClick:x=>b(r.row.id)},null,8,["onClick"]),e(c,{size:"sm",color:"secondary",push:"",glossy:"",icon:"edit",onClick:x=>w(r.row.id)},null,8,["onClick"]),e(c,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete",onClick:x=>E(r.row.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])]))}}),oe=()=>H("users-trashed",["users-trashed"],{included:"roles"},{staleTime:1e3*60*60}),se=()=>J("users-force-delete","users-trashed"),re=()=>K("/users-restore","users","users-trashed"),ae={class:"flex justify-end q-gutter-md q-mb-md"},le={key:0},ie={key:1},te=$({__name:"TablaUserEliminado",setup(z){const a=_([]),i=_(!1),u=_(!1),p=_(""),{data:y,isLoading:h}=oe(),{eliminarRecurso:b}=se(),{restaurarRecurso:w}=re(),E=d=>{b(d)},m=()=>{i.value=!0},U=d=>{u.value=!0,p.value=d},r=()=>{const d=a.value.map(l=>l.id.toString());w(d),a.value=[]},x=()=>{const d=a.value.map(l=>l.id.toString());b(d),a.value=[]};return(d,l)=>(f(),g("div",null,[e(R,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=s=>u.value=s),"recurso-id":p.value,icon:"delete_forever",onEliminar:E,mensaje:"\xBFEstas seguro de eliminar este usuario? Si se llega a eliminar, todos los datos se perder\xE1n para simpre y por simpre. \xA1Piensalo!"},null,8,["modelValue","recurso-id"]),e(R,{modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=s=>i.value=s),"recurso-id":a.value,icon:"delete_forever",onEliminar:x,mensaje:"\xBFEstas seguro de eliminar estos usuarios? Si se llega a eliminar, todos los datos se perder\xE1n para simpre y por simpre. \xA1Pi\xE9nsalo!"},null,8,["modelValue","recurso-id"]),V("div",ae,[e(c,{disable:!a.value.length,color:"secondary",icon:"restore",onClick:r},null,8,["disable"]),e(c,{disable:!a.value.length,color:"negative",icon:"delete_forever",onClick:m},null,8,["disable"])]),e(T,{flat:"",bordered:"",rows:n(y),columns:n(q),"row-key":"id",loading:n(h),pagination:{rowsPerPage:10},selection:"multiple",selected:a.value,"onUpdate:selected":l[2]||(l[2]=s=>a.value=s)},{body:o(s=>[e(N,{props:s},{default:o(()=>[e(t,null,{default:o(()=>[e(D,{modelValue:s.selected,"onUpdate:modelValue":Q=>s.selected=Q},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(t,{key:"name",props:s},{default:o(()=>[v(k(s.row.name),1)]),_:2},1032,["props"]),e(t,{key:"email",props:s},{default:o(()=>[v(k(s.row.email),1)]),_:2},1032,["props"]),e(t,{key:"rol",props:s},{default:o(()=>[s.row.roles&&s.row.roles.length>0?(f(),g("div",le,k(s.row.roles[0].name),1)):(f(),g("div",ie,"Sin rol"))]),_:2},1032,["props"]),e(t,{key:"accion",props:s},{default:o(()=>[e(j,{push:""},{default:o(()=>[e(c,{size:"sm",color:"secondary",push:"",glossy:"",icon:"restore",onClick:Q=>n(w)(s.row.id)},{default:o(()=>[e(P,null,{default:o(()=>[v(" Restaurar usuario ")]),_:1})]),_:2},1032,["onClick"]),e(c,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete_forever",onClick:Q=>U(s.row.id)},{default:o(()=>[e(P,null,{default:o(()=>[v(" Forzar eliminaci\xF3n ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","selected"])]))}}),ne={class:"flex justify-between items-center"},ue=V("div",{class:"fontsize-15 text-weight-light"},"Usuarios",-1),me=V("div",{class:"fontsize-15 text-weight-light"},"Usuarios eliminados",-1),eo=$({__name:"ListarUsuario",setup(z){const a=S(),i=()=>{a.push({name:"crear-usuario"})},u=I(),p=[{label:"Usuarios",icon:"people"}];return(y,h)=>(f(),F(L,{padding:""},{default:o(()=>[e(M,{pages:p,titlePage:"Lista de usuarios"}),e(B,null,{default:o(()=>[e(C,null,{default:o(()=>[V("div",ne,[ue,e(c,{label:"Nuevo",icon:"add_circle_outline",color:"secondary",size:"md",padding:"xs",onClick:i})])]),_:1}),e(C,null,{default:o(()=>[e(ee)]),_:1})]),_:1}),n(u)==="admin"?(f(),F(B,{key:0,class:"q-mt-md"},{default:o(()=>[e(C,null,{default:o(()=>[me]),_:1}),e(C,null,{default:o(()=>[e(te)]),_:1})]),_:1})):A("",!0)]),_:1}))}});export{eo as default};
