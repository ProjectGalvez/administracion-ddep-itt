import{a as x,Q as B}from"./QCard.cb508ff7.js";import{v as w,aM as Q,c as U,q as g,s as q,d as l,t as n,ac as P,F as E,A as a,z as C,B as y,aa as A,u as b,ar as T,ab as z,Q as S,r as $,as as F,x as O}from"./index.6aee2e30.js";import{a as L,Q as G}from"./QForm.f7dbdbf9.js";import{Q as H}from"./QPage.6971c865.js";import{Q as K}from"./QDialog.84ddac0d.js";import{C as I}from"./ClosePopup.7bc30a2d.js";import{d as D}from"./documentosApi.f9b655d1.js";import{Q as h}from"./QInput.fb482f67.js";import{g as j}from"./errorUtils.9be85d5d.js";import{u as N}from"./useQueryClient.esm.ef5065e6.js";import{u as R}from"./useMutation.esm.2b00b620.js";import{Q as k}from"./QSelect.e7df04d7.js";import{u as J}from"./useQuery.esm.76380881.js";import{_ as W}from"./SelectEmpresa.b2bc6e0d.js";import{_ as X}from"./SelectPeriodo.e33ad6f7.js";import{u as Y}from"./useObtenerCarreras.bd3d3ae0.js";import{_ as Z,a as ee}from"./SelectProyecto.67dafd0f.js";import{_ as oe}from"./BreadcrumbNav.15d15e07.js";import"./use-dark.6d3765c8.js";import"./focus-manager.05708ea9.js";import"./use-prevent-scroll.46e9c667.js";import"./focusout.012d42f6.js";import"./axios.a596eead.js";import"./use-key-composition.138705f4.js";import"./uid.42677368.js";import"./use-form.7a2b9d0c.js";import"./utils.esm.df383359.js";import"./mutation.esm.5dbe1dbb.js";import"./QChip.ec11ad7b.js";import"./QItem.7d9afe8e.js";import"./QItemLabel.7e1a4be7.js";import"./QMenu.7408e287.js";import"./position-engine.9bef8d76.js";import"./selection.76539ba5.js";import"./format.2bc25e5f.js";import"./useObtenerPeriodos.420e1b00.js";import"./useRecursosMultiples.c09a7537.js";const le=a("div",{class:"fontsize-15 text-weight-light"},"Introduce los datos",-1),ae={class:"row q-col-gutter-md"},se={class:"col-12"},te={class:"col-xs-12"},re=a("span",{class:"required-star"},"*",-1),ne={class:"col-xs-12"},ie=a("span",{class:"required-star"},"*",-1),ue={class:"col-xs-12"},de={class:"col-xs-12"},ce={class:"col-xs-12"},me={class:"col-xs-12 col-sm-7"},pe=w({__name:"FormAsesorDialog",props:{asesor:{},loading:{type:Boolean},errorServer:{}},emits:["guardar"],setup(_,{emit:t}){const u=_,s=Q(u,"asesor"),v=Q(u,"loading"),c=Q(u,"errorServer"),d=c.value,p=()=>{t("guardar",s.value)},V=U(()=>j(c.value));return(r,o)=>(g(),q(E,null,[l(x,null,{default:n(()=>[le]),_:1}),l(L,{onSubmit:P(p,["prevent"])},{default:n(()=>[l(x,null,{default:n(()=>[a("div",ae,[a("div",se,[c.value?(g(),C(G,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:n(()=>{var e;return[y(A(((e=b(d))==null?void 0:e.message)||"")+" ",1),a("ul",null,[(g(!0),q(E,null,T(V.value,i=>(g(),q("li",{key:i},A(i),1))),128))])]}),_:1})):z("",!0)]),a("div",te,[l(h,{modelValue:s.value.nombre,"onUpdate:modelValue":o[0]||(o[0]=e=>s.value.nombre=e),"label-slot":"",rules:[e=>!!e||"El nombre del asesor es requerido",e=>e.length>3&&e.length<255||"Debe tener m\xE1s de 3 caracteres y menos de 255"]},{label:n(()=>[y(" Nombre del asesor "),re]),_:1},8,["modelValue","rules"])]),a("div",ne,[l(h,{modelValue:s.value.apellidos,"onUpdate:modelValue":o[1]||(o[1]=e=>s.value.apellidos=e),"label-slot":"",rules:[e=>!!e||"Los apellidos son requeridos",e=>e.length>3&&e.length<255||"Debe tener m\xE1s de 3 caracteres y menos de 255"]},{label:n(()=>[y(" Apellidos "),ie]),_:1},8,["modelValue","rules"])]),a("div",ue,[l(h,{modelValue:s.value.titulo,"onUpdate:modelValue":o[2]||(o[2]=e=>s.value.titulo=e),label:"T\xEDtulo o carrera"},null,8,["modelValue"])]),a("div",de,[l(h,{modelValue:s.value.email,"onUpdate:modelValue":o[3]||(o[3]=e=>s.value.email=e),label:"Email"},null,8,["modelValue"])]),a("div",ce,[l(h,{modelValue:s.value.telefono,"onUpdate:modelValue":o[4]||(o[4]=e=>s.value.telefono=e),label:"Tel\xE9fono",mask:"(###) ### - ####"},null,8,["modelValue"])]),a("div",me,[l(S,{label:"Guardar",color:"primary",type:"submit",loading:v.value},null,8,["loading"])])])]),_:1})]),_:1},8,["onSubmit"])],64))}}),_e=w({__name:"DialogAsesor",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(_,{emit:t}){const u=_,s=$({id:0,nombre:"",apellidos:"",email:"",telefono:"",titulo:""}),v=async e=>{try{const{data:i}=await D.post("/asesores",e);return i}catch(i){throw i}},c=N(),d=$(null),{mutate:p,isLoading:V}=R(v,{onSuccess:()=>{c.invalidateQueries({queryKey:["asesores"],exact:!1}),t("update:modelValue",!1)},onError:e=>{var i;e.response?d.value=(i=e.response)==null?void 0:i.data:d.value=e}}),r=e=>{p(e)},o=U({get:()=>u.modelValue,set:e=>t("update:modelValue",e)});return(e,i)=>(g(),C(K,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=f=>o.value=f)},{default:n(()=>[l(B,null,{default:n(()=>[l(pe,{asesor:s.value,loading:b(V),errorServer:d.value,onGuardar:r},null,8,["asesor","loading","errorServer"]),l(x,null,{default:n(()=>[F(l(S,{label:"Cancelar",color:"negative"},null,512),[[I]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ve=async()=>{const{data:_}=await D.get("/estudiantes-sin-residencia");return _},ge=()=>{const{isLoading:_,data:t}=J(["estudiantes-sin-residencia"],ve,{keepPreviousData:!0,staleTime:36e5});return{isLoading:_,data:t}},Ve=w({__name:"SelectEstudiantesSInResidencia",props:{modelValue:{},label:{},rules:{}},emits:["update:modelValue"],setup(_,{emit:t}){const u=_,s=U({get:()=>u.modelValue,set:d=>t("update:modelValue",d)}),{data:v,isLoading:c}=ge();return(d,p)=>(g(),C(k,{"use-input":"",modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=V=>s.value=V),label:u.label,loading:b(c),"option-value":"id","option-label":"nombre",options:b(v),"emit-value":"","map-options":"",rules:u.rules},null,8,["modelValue","label","loading","options","rules"]))}}),fe=a("div",{class:"fontsize-15 text-weight-light"},"Introduce los datos",-1),be={class:"row q-col-gutter-md"},ye={class:"col-12"},xe={class:"col-xs-12"},Se=a("span",{class:"required-star"},"*",-1),$e={class:"col-xs-12"},he=a("span",{class:"required-star"},"*",-1),Qe={class:"col-xs-12"},qe=a("span",{class:"required-star"},"*",-1),we={class:"col-xs-12 col-sm-7"},Ce=w({__name:"FormProyectoDialog",props:{proyecto:{},loading:{type:Boolean},errorServer:{}},emits:["guardar"],setup(_,{emit:t}){const u=_,s=Q(u,"proyecto"),v=Q(u,"loading"),c=Q(u,"errorServer"),d=c.value,{data:p,isLoading:V}=Y(),r=()=>{t("guardar",s.value)},o=["Banco de Proyectos","Propuesta propia","Trabajador"],e=U(()=>j(c.value));return(i,f)=>(g(),q(E,null,[l(x,null,{default:n(()=>[fe]),_:1}),l(L,{onSubmit:P(r,["prevent"])},{default:n(()=>[l(x,null,{default:n(()=>[a("div",be,[a("div",ye,[c.value?(g(),C(G,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:n(()=>{var m;return[y(A(((m=b(d))==null?void 0:m.message)||"")+" ",1),a("ul",null,[(g(!0),q(E,null,T(e.value,M=>(g(),q("li",{key:M},A(M),1))),128))])]}),_:1})):z("",!0)]),a("div",xe,[l(h,{modelValue:s.value.nombre,"onUpdate:modelValue":f[0]||(f[0]=m=>s.value.nombre=m),"label-slot":"",rules:[m=>!!m||"El nombre del proyecto es requerido",m=>m.length>3&&m.length<255||"Debe tener m\xE1s de 3 caracteres y menos de 255"]},{label:n(()=>[y(" Nombre del proyecto "),Se]),_:1},8,["modelValue","rules"])]),a("div",$e,[l(k,{modelValue:s.value.tipo,"onUpdate:modelValue":f[1]||(f[1]=m=>s.value.tipo=m),options:o,label:"G\xE9nero","option-value":"id","option-label":"label","label-slot":"",rules:[m=>!!m||"Selecciona un tipo"]},{label:n(()=>[y(" Tipo de proyecto "),he]),_:1},8,["modelValue","rules"])]),a("div",Qe,[l(k,{modelValue:s.value.carrera_id,"onUpdate:modelValue":f[2]||(f[2]=m=>s.value.carrera_id=m),options:b(p),"label-slot":"","option-value":"id","option-label":"nombre","emit-value":"","map-options":"",rules:[m=>!!m||"Selecciona una carrera"],loading:b(V)},{label:n(()=>[y(" Carrera "),qe]),_:1},8,["modelValue","options","rules","loading"])]),a("div",we,[l(S,{label:"Guardar",color:"primary",type:"submit",loading:v.value},null,8,["loading"])])])]),_:1})]),_:1},8,["onSubmit"])],64))}}),Ue=w({__name:"DialogProyecto",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(_,{emit:t}){const u=_,s=$({id:0,nombre:"",tipo:"",carrera_id:null}),v=async e=>{try{const{data:i}=await D.post("/proyectos",e);return i}catch(i){throw i}},c=N(),d=$(null),{mutate:p,isLoading:V}=R(v,{onSuccess:()=>{c.invalidateQueries({queryKey:["proyectos"],exact:!1}),t("update:modelValue",!1)},onError:e=>{var i;e.response?d.value=(i=e.response)==null?void 0:i.data:d.value=e}}),r=e=>{p(e)},o=U({get:()=>u.modelValue,set:e=>t("update:modelValue",e)});return(e,i)=>(g(),C(K,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=f=>o.value=f)},{default:n(()=>[l(B,null,{default:n(()=>[l(Ce,{proyecto:s.value,loading:b(V),errorServer:d.value,onGuardar:r},null,8,["proyecto","loading","errorServer"]),l(x,null,{default:n(()=>[F(l(S,{label:"Cancelar",color:"negative"},null,512),[[I]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ee=_=>{const t=async d=>{try{const{data:p}=await D.patch("/asignar-residencia/"+d.estudiante_id,d,{params:{id:d.estudiante_id}});return p}catch(p){throw p}},u=O(),s=N(),{mutate:v,isLoading:c}=R(t,{onSuccess:()=>{s.invalidateQueries({queryKey:["estudiantes"],exact:!1}),s.invalidateQueries({queryKey:["estudiantes-sin-residencia"],exact:!1}),s.invalidateQueries({queryKey:["residentes"],exact:!1}),u.push({name:"listar-residente"})}});return{mutate:v,isLoading:c}},Ae={class:"row"},De={class:"col"},ke={class:"row"},Be={class:"col-xs-12 col-sm-8"},Pe={class:"row q-col-gutter-md"},Le={class:"col-xs-12 col-sm-10"},Ne={class:"col-xs-12 col-sm-10"},Re={class:"col-xs-12 col-sm-2"},Me={class:"col-xs-12 col-sm-10"},Te={class:"col-xs-12 col-sm-2"},ze={class:"col-xs-12 col-sm-10"},Fe={class:"col-xs-12 col-sm-10"},Ge={class:"col-xs-12 col-sm-7"},Co=w({__name:"CrearResidente",setup(_){const t=$({estudiante_id:"",proyecto_id:null,area_id:null,periodo_id:null,asesor_interno_id:null}),u=$(!1),s=$(!1),{mutate:v,isLoading:c}=Ee(t.value.estudiante_id),d=()=>{v(t.value)},p=[{label:"Residentes",icon:"history_edu",to:"listar-residente"},{label:"Asignar residencia",icon:"add_circle_outline"}];return(V,r)=>(g(),C(H,{padding:""},{default:n(()=>[l(oe,{pages:p,titlePage:"Asignar residencia a un estudiante"}),l(Ue,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=o=>u.value=o)},null,8,["modelValue"]),l(_e,{modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=o=>s.value=o)},null,8,["modelValue"]),a("div",Ae,[a("div",De,[l(B,null,{default:n(()=>[l(x,null,{default:n(()=>[y(" Asignar residencia ")]),_:1}),l(L,{onSubmit:P(d,["prevent"])},{default:n(()=>[l(x,null,{default:n(()=>[a("div",ke,[a("div",Be,[a("div",Pe,[a("div",Le,[l(Ve,{modelValue:t.value.estudiante_id,"onUpdate:modelValue":r[2]||(r[2]=o=>t.value.estudiante_id=o),label:"Selecciona un estudiante",rules:[o=>!!o||"Selecciona un estudiante"]},null,8,["modelValue","rules"])]),a("div",Ne,[l(Z,{modelValue:t.value.proyecto_id,"onUpdate:modelValue":r[3]||(r[3]=o=>t.value.proyecto_id=o),label:"Proyecto"},null,8,["modelValue"])]),a("div",Re,[l(S,{label:"Nuevo proyecto",size:"sm",onClick:r[4]||(r[4]=o=>u.value=!0)})]),a("div",Me,[l(ee,{modelValue:t.value.asesor_interno_id,"onUpdate:modelValue":r[5]||(r[5]=o=>t.value.asesor_interno_id=o),label:"Asesor interno"},null,8,["modelValue"])]),a("div",Te,[l(S,{label:"Nuevo asesor",size:"sm",onClick:r[6]||(r[6]=o=>s.value=!0)})]),a("div",ze,[l(X,{modelValue:t.value.periodo_id,"onUpdate:modelValue":r[7]||(r[7]=o=>t.value.periodo_id=o),label:"Selecciona un periodo",rules:[o=>!!o||"Selecciona un periodo"]},null,8,["modelValue","rules"])]),a("div",Fe,[l(W,{modelValue:t.value.area_id,"onUpdate:modelValue":r[8]||(r[8]=o=>t.value.area_id=o),label:"Selecciona una empresa",rules:[o=>!!o||"Selecciona una empresa"]},null,8,["modelValue","rules"])]),a("div",Ge,[l(S,{label:"Asignar residencia",color:"primary",type:"submit",loading:b(c)},null,8,["loading"])])])])])]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])]),_:1}))}});export{Co as default};
